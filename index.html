<html>
	<head>
		<title>Dscho's Git log</title>
		<meta http-equiv="Content-Type"
			content="text/html; charset=UTF-8"/>
	</head>
	<body style="width:800px;background-image:url(dscho.git?a=blob_plain;hb=832be85c785c80202f17b87db7f063ae57ec2cac;f=paper.jpg);background-repeat:repeat-y;background-attachment:scroll;padding:0px;">
		<div style="width:610px;margin-left:120px;margin-top:50px;align:left;vertical-align:top;">
			<h1>Dscho's Git log</h1>
			<div style="position:absolute;top:50px;left:810px;width=400px">
			<table width=400px bgcolor=#e0e0e0 border=1>
			<tr><th>Table of contents:</th></tr>
			<tr><td>
			<p><ul>
			<li><a href=#1239975597>17 Apr 2009 No time for Git</a>
			<li><a href=#1238970571>06 Apr 2009 How to recover from a hackathon</a>
			<li><a href=#1236554268>09 Mar 2009 So, what is missing from my <i>rebase-i-p</i> branch?</a>
			<li><a href=#1236479389>08 Mar 2009 New Git for Windows version</a>
			<li><a href=#1235092615>20 Feb 2009 Code reviews</a>
			<li><a href=#1234409395>12 Feb 2009 Interactive <i>rebase</i> just learnt a new command: <i>topic</i></a>
			<li><a href=#1234320806>11 Feb 2009 Thunderbird, oh Thunderbird, you always make my small brain hurt</a>
			<li><a href=#1234141489>09 Feb 2009 <i>format-patch --thread</i> and Alpine</a>
			<li><a href=#1234140696>09 Feb 2009 <i>rebase</i> updates</a>
			<li><a href=#1234040744>07 Feb 2009 The infamous <i>mark</i> command in the <i>rebase</i> command</a>
			</ul></p>
			<a href=dscho.git?a=blob_plain;hb=4efb9dfc1f5b0ebdb59ceb849e602b0d598ef61c;f=index.html>Older posts</a>
			</td></tr></table>
			<br>
			<div style="text-align:right;">
			<a href="dscho.git?a=blob_plain;hb=blog;f=blog.rss"
			   title="Subscribe to my RSS feed"
			   class="rss" rel="nofollow"
			   style="background-color:orange;text-decoration:none;color:white;font-family:sans-serif;">RSS</a>
			</div>
			<br>
			<table width=400px bgcolor=#e0e0e0 border=1>
			<tr><th>About this blog:</th></tr>
			<tr><td>
			<p>It is an active <a href=http://repo.or.cz/w/git/dscho.git?a=blob_plain;f=index.html;hb=5f002cab57a837125a8f901bcd1f3c1477bc3119>abuse</a> of <a href=http://repo.or.cz/>repo.or.cz</a>,
			letting gitweb unpack the objects in the current tip of the branch <i>blog</i>,
			including the images and the RSS feed.
			</p><p>
			Publishing means running a script that collects the posts, turns them into
			HTML, makes sure all the images are checked in, and pushes the result.
			</p><p>
			This blog also serves to grace the world with Dscho's random thoughts on and
			around Git.
			</p>
			</td></tr></table>
			<br>
			<table width=400px bgcolor=#e0e0e0 border=1>
			<tr><th>Links:</th></tr>
			<tr><td>
			<ul>
			<li> <a href=http://git-scm.com/>Git's homepage</a>
			<li> <a href=http://gitster.livejournal.com/>Junio's blog</a>
			<li> <a href=http://www.spearce.org/>Shawn's blog</a> seems to be sitting
			      idle ever since he started working for Google...
			<li> <a href=http://torvalds-family.blogspot.com/>Linus' blog</a> does not
			      talk much about Git...
			<li> Scott Chacon's <a href=http://whygitisbetterthanx.com/>Why Git is better
			     than X</a> site
			<li> <a href=http://vilain.net/>The blog of mugwump</a>
			<li> <a href=http://merlyn.vox.com/>Merlyn's blog</a>
			<li> <a href=http://blogs.gnome.org/newren/>Elijah Newren</a> chose the
			      same path as Cogito, offering an alternative porcelain (an approach
			      that is doomed in my opinion)
			<li> <a href=http://msysgit.googlecode.com/>The msysGit project</a>, a (mostly)
			      failed experiment to lure the many Windows developers out there to
			      contribute to Open Source for a change.
			</ul>
			</td></tr></table>
			<br>
			<table width=400px bgcolor=#e0e0e0 border=1>
			<tr><th>Google Ads:</th></tr>
			<tr><td>
			<script type="text/javascript"><!--
			google_ad_client = "pub-5106407705643819";
			/* 300x250, created 1/22/09 */
			google_ad_slot = "6468207338";
			google_ad_width = 300;
			google_ad_height = 250;
			//-->
			</script>
			<script type="text/javascript"
			src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
			</script>
			</td></tr></table>
			</div>
			<h6>Friday, 17th of April, Anno Domini MMIX, at the hour of the Monkey</h6>
			<a name=1239975597>
			<h2>No time for Git</h2>

			<p>
			</p><p>
			It is a shame, but most of my Git time budget is taken by msysGit these
			days.
			</p><p>
			But at least msysGit is moving again; I'll probably write a Herald about
			it.
			</p>
			<h6>Monday, 6th of April, Anno Domini MMIX, at the hour of the Rat</h6>
			<a name=1238970571>
			<h2>How to recover from a hackathon</h2>

			<p>
			</p><p>
			Phew, 2 crazy and fantastic weeks are behind me.  But it takes its toll:
			a weekend I was more offline than online.
			</p><p>
			Things that are important now: relax. sleep. take a walk. learn to sleep
			more than 4 hours a night again. learn to watch a movie without thinking
			about code. go for a run.
			</p><p>
			And after recovering, back to the rebase-i-p branch!
			</p>
			<h6>Monday, 9th of March, Anno Domini MMIX, at the hour of the Rat</h6>
			<a name=1236554268>
			<h2>So, what is missing from my <i>rebase-i-p</i> branch?</h2>

			<p>
			</p><p>
			I regularly use <i>rebase -i -p</i> these days, to update my personal Git
			tree (which used to be <i>my-next</i>).
			</p><p>
			There are a few things missing before I can start assembling a patch
			series for submission:
			</p><p>
			<ul>
			<li>I need to handle the commit parents which are outside of the rebased
			ones properly.  In other words, when a commit is picked whose parent is
			not rebased, it needs to be rebased onto $ONTO.
			<li>The patch which uses patch-id to generate DROPPED directly also tries to
			consolidate the handling of DROPPED commits by putting them into REWRITTEN
			instead of DROPPED, but that breaks the tests.  So, this patch needs to be
			split.
			<li>I want to introduce one more command, <i>rephrase</i>, which allows you to
			modify the commit message, and nothing more, and <i>halt</i>, which does the
			same as <i>edit</i> without <i>pick</i>.  Then there needs to be a new test script
			for those commands, and this will be an early patch series.
			<li>Time.  I need time, desperately.  If my day job was not as exciting as it
			is, I would have more time for Git.  As it is, I have to budget my time so
			that I get anything done at all.
			</ul>
			</p><p>
			These issues have been postponed due to Steffen taking a well-deserved
			vacation, which means that I have to act as msysGit maintainer again.
			</p><p>
			And this coming week, I will have other things to do in all likeliness, so
			that I expect to be able to submit a <i>rebase -i -p</i> patch series only next
			week.  If not then, due to a heavy workload, it will be postponed to early
			April.
			</p><p>
			Oh well, the joys of being excited by several competing projects! &#x263a;
			</p>
			<h6>Sunday, 8th of March, Anno Domini MMIX, at the hour of the Tiger</h6>
			<a name=1236479389>
			<h2>New Git for Windows version</h2>

			<p>
			</p><p>
			Phew.  That was quite a day, almost exclusively spent on finishing that
			installer.  The worst part: updating GCC seemed not to be such a good idea
			after all...
			</p><p>
			For Windows, we need to use the printf format <i>%I64u</i> (which is
			non-standard, in the common way of Microsoft) if you want to print 64-bit
			wide unsigned numbers.  The rest of the world accepts the standard <i>%llu</i>.
			</p><p>
			After upgrading to the new GCC, a lot of warnings appeared, complaining
			about <i>%I64u</i>.  The warnings went away when I replaced the format with
			<i>%llu</i>.
			</p><p>
			Being the naive I am, I mistook that for a sign that we could finally go
			more standards-compliant.
			</p><p>
			However, it only means that we have to live with the warnings for now, as
			the C runtime provided on Windows still strongly disagrees with standards
			(and it has to continue to do so, lest it break existing programs).
			</p><p>
			Sigh.
			</p><p>
			At least I have the feeling that I caught the most important bugs before
			releasing.
			</p>
			<h6>Friday, 20th of February, Anno Domini MMIX, at the hour of the Buffalo</h6>
			<a name=1235092615>
			<h2>Code reviews</h2>

			<p>
			</p><p>
			It has been said that reviewing patches is a most thankless job.  As I really
			like the elegance of Git's source code, and care a lot about it, I did not
			think that it was thankless, just a little bit tedious (especially when the
			patch authors mistake criticism for personal attacks).
			</p><p>
			Usually, I am pretty good at ignoring insults as responses to my comments;
			after all, I have a lot more enjoyable things to do than to spend time talking
			to a guy who shows how wise he is when he thinks that I criticize him
			<u>personally</u> when I just try to enhance his work, by offering a little bit of
			my knowledge.
			</p><p>
			However, in the last days, three people really seemed to want to insult me,
			to make me go away, to stop the fun I have with Git.
			</p><p>
			And they almost succeeded.
			</p><p>
			So I guess it is time to reassess my priorities, and maybe stop reviewing
			Git patches altogether.
			</p>
			<h6>Thursday, 12th of February, Anno Domini MMIX, at the hour of the Tiger</h6>
			<a name=1234409395>
			<h2>Interactive <i>rebase</i> just learnt a new command: <i>topic</i></h2>

			<p>
			</p><p>
			Today I am pretty pleased with myself.  Two projects at my day job got a real
			boost, and I implemented a shortcut that avoids the ugly 'bookmark' statement
			in rebase scripts most of the time.
			</p><p>
			A typical rebase script, generated by <i>git rebase -i -p $COMMIT</i> will look
			something like this:
			</p><p>
			<table
							border=1 bgcolor=black>
						<tr><td bgcolor=lightblue colspan=3>
				<pre>                                                                                </pre>
			</td></tr>
			<tr><td>
				<table cellspacing=5 border=0
					 style="color:white;">
				<tr><td>
					<pre>
pick 1234567 My first commit
topic begin super-cool-feature
pick 2345678 The super cool feature
pick 3456789 Documentation for the super cool feature
topic end super-cool-feature
</pre>
							</td></tr>
							</table>
						</td></tr>
						</table>
			</p><p>
			The result will be a merge commit at the HEAD whose first parent is
			"My first commit", whose second parent is "Documentation for the super
			cool feature" and whose commit message is "Merge branch 'super-cool-feature'".
			</p><p>
			Side note: internally, <i>topic begin $NAME [at $COMMIT]</i> will be handled as if
			you wrote <i>bookmark merge-parent-of-$NAME; goto $COMMIT</i>, and
			<i>topic end $NAME [$MESSAGE]</i> will be handled as if you wrote
			<i>bookmark $NAME; goto merge-parent-of-$NAME; merge parents $NAME [original $MARK Merge branch '$NAME']</i>.
			</p><p>
			Of course, being more concise, the 'topic' statement is not only nicer to the
			eye, but also less error-prone.
			</p><p>
			And hopefully many people will agree with me that this rebase script is pretty
			intuitive.
			</p>
			<h6>Wednesday, 11th of February, Anno Domini MMIX, at the hour of the Tiger</h6>
			<a name=1234320806>
			<h2>Thunderbird, oh Thunderbird, you always make my small brain hurt</h2>

			<p>
			</p><p>
			There was a lengthy discussion on the Git mailing list about using Thunderbird,
			a not quite unpopular mailing program, to send inline patches.
			</p><p>
			It is really kind of sad that the Thunderbird developers do not see how
			stubbornly they offend quite a number of people and scare them away from their
			program.  After all, you should try to be liberal in what you accept and strict
			in what you emit.  No, that does not mean that you should force others to
			switch their mailers because you strictly adher to your philosophy in what you
			emit, ignoring the rest of the world.
			</p><p>
			In any case, I am not affected (as long as I do not get mails from a poor soul
			stuck with Thunderbird).
			</p><p>
			But I was a bit mean to that Thunderbird guy I dragged into the discussion, and
			he seems really offended.
			</p><p>
			So I thought I'd give him a real reason to feel offended: I'll just do his work: 
			</p><p>
			http://<a href=http://repo.or.cz>repo.or.cz</a>/w/UnFlowedThunderbird.git
			</p><p>
			It took my free time of two days, being not a Thunderbird developer myself.
			Hopefully it works, and hopefully some people will feel really ashamed now.
			</p>
			<h6>Monday, 9th of February, Anno Domini MMIX, at the hour of the Buffalo</h6>
			<a name=1234141489>
			<h2><i>format-patch --thread</i> and Alpine</h2>

			<p>
			</p><p>
			I started recently to pipe the output of
			<i>git format-patch --cover-letter --stdout ...</i> directly into the
			<i>postponed-msgs</i> folder Alpine uses, instead of pasting files into the
			mailer.
			</p><p>
			The idea is to pretend that I continue a postponed mail, but in reality I
			never wrote it, <i>format-patch</i> did.
			</p><p>
			However, I had problems with the <i>--thread</i> option that is implied by
			<i>--cover-letter</i>.  Alpine always generated new message IDs without adjusting
			the <i>In-reply-to:</i> and <i>References:</i> headers of the other mails.
			</p><p>
			Now I found out that the reason is that the <i>Fcc:</i> headers were missing in
			the mails, and Alpine generated them, making up new message IDs in the process.
			</p><p>
			Therefore I have an alias now which sets not only the <i>Fcc:</i> header, but also
			the <i>To:</i> headers by rewriting the stream using <i>sed</i>.  This is slightly
			ugly, but so is the handling of headers in <i>format-patch</i>: if you thought
			you could specify arbitrary headers using the command line, you are mistaken:
			you can do that only by editing the config.
			</p><p>
			While at it, I also noticed a bug whereby <i>--thread --in-reply-to=...</i> simply
			forgets the <i>--thread</i>.  Maybe this week I will find time to address this bug.
			</p>
			<h6>Monday, 9th of February, Anno Domini MMIX, at the hour of the Buffalo</h6>
			<a name=1234140696>
			<h2><i>rebase</i> updates</h2>

			<p>
			</p><p>
			Phew.  The last few days, I was mainly chasing bugs I introduced due to being
			too tired to work on the merge-preserving, interactive <i>rebase</i>.
			</p><p>
			But finally I have something I can start working with.  After my failed
			experiment to use git-blame to split topic branches, I will sort the commits
			in my <i>my-next</i> branch into topic branches manually.
			</p><p>
			Then I will add an option to <i>rebase -i -p</i> to rewrite refs which point to
			rewritten commits, so that I can have branches <i>rebase-i-p</i>, <i>add-e</i>, etc
			and all of them are automatically updated when I <i>rebase -i -p</i> the <i>my-next</i>
			branch.
			</p><p>
			In the process, not only have I learnt the value of the <i>bookmark</i> command,
			but made quite a few-much needed cleanups (which make
			<i>git-rebase--interactive.sh</i> longer, but much more understandable).
			</p><p>
			Hopefully Stephan will pick the changes in the "rebase protocol" up, and then
			we can have a sequencer with which I can start to make a graphical interactive
			rebase using git-gui.  Or gitk.
			</p><p>
			Maybe.
			</p>
			<h6>Saturday, 7th of February, Anno Domini MMIX, at the hour of the Pig</h6>
			<a name=1234040744>
			<h2>The infamous <i>mark</i> command in the <i>rebase</i> command</h2>

			<p>
			</p><p>
			I realized today how easy it is to lose commits with the "merge preserving"
			mode of the interactive rebase.  In my case, it was when I tried to move a
			bunch of commits from the tip of my branch into a topic branch.
			</p><p>
			But after moving the commits, I forgot to update the parent of the merge
			commit.  Possibly a mark command could have helped.  The very same command
			I called a nightmare for usability.
			</p><p>
			So I was wrong.  Big news.  &#x263a;
			</p><p>
			However, I think that the syntax "mark :1" is something best left for
			machine consumption, not for human beings.
			</p><p>
			But I have an idea: we could use some garbled commit subject, or in case of
			merge parents, the merge subject as some human readable title of the mark.
			</p><p>
			The rebase script would then look something like this:
			</p><p>
			<table
							border=1 bgcolor=black>
						<tr><td bgcolor=lightblue colspan=3>
				<pre>                                                                                </pre>
			</td></tr>
			<tr><td>
				<table cellspacing=5 border=0
					 style="color:white;">
				<tr><td>
					<pre>
pick abcdefg Some ultra cool commit
bookmark ultra-cool
goto upstream
pick hijklmn Some other cool commit
merge parent ultra-cool Merge 'ultra-cool' into master
</pre>
							</td></tr>
							</table>
						</td></tr>
						</table>
			</p><p>
			The good news is: I added code that refuses to finish a rebase when there
			are commits that were rewritten, but not part of the new HEAD's ancestry.
			</p>
		</div>
	</body>
</html>
